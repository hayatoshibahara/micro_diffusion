ğŸŸ© Python 3.12.11
ğŸŸ© Fri Dec  5 16:53:34 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.163.01             Driver Version: 550.163.01     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 4090        Off |   00000000:01:00.0 Off |                  Off |
|  0%   34C    P8             13W /  450W |      68MiB /  24564MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
+-----------------------------------------------------------------------------------------+

ğŸŸ¦ matplotlib data path: /opt/miniconda/envs/py312/lib/python3.12/site-packages/matplotlib/mpl-data
ğŸŸ¦ CONFIGDIR=/root/.config/matplotlib
ğŸŸ¦ interactive is False
ğŸŸ¦ platform is linux
ğŸŸ¦ CACHEDIR=/root/.cache/matplotlib
ğŸŸ¦ Using fontManager instance from /root/.cache/matplotlib/fontlist-v390.json
ğŸŸ¦ Popen(['git', 'version'], cwd=/workspaces/micro_diffusion, stdin=None, shell=False, universal_newlines=False)
ğŸŸ¦ Popen(['git', 'version'], cwd=/workspaces/micro_diffusion, stdin=None, shell=False, universal_newlines=False)
ğŸŸ¦ Trying paths: ['/root/.docker/config.json', '/root/.dockercfg']
ğŸŸ¦ No config file found
ğŸŸ© Setting seed to 18
ğŸŸ© PyTorch 2.6.0+cu124
ğŸŸ© Transformers 4.56.2
ğŸŸ© DATA_DIR='/root/.cache/micro_diffusion/data'
ğŸŸ© MODEL_DIR='/root/.cache/micro_diffusion/models'
ğŸŸ© DiTã‚’åˆæœŸåŒ– input_size=32 patch_size=2 in_channels=4 dim=512 depth=16 head_dim=32 multiple_of=256 caption_channels=1024 pos_interp_scale=1.0 norm_eps=1e-06 depth_init=True qkv_multipliers=array([0.5       , 0.53333333, 0.56666667, 0.6       , 0.63333333,
       0.66666667, 0.7       , 0.73333333, 0.76666667, 0.8       ,
       0.83333333, 0.86666667, 0.9       , 0.93333333, 0.96666667,
       1.        ]) ffn_multipliers=array([0.5       , 0.73333333, 0.96666667, 1.2       , 1.43333333,
       1.66666667, 1.9       , 2.13333333, 2.36666667, 2.6       ,
       2.83333333, 3.06666667, 3.3       , 3.53333333, 3.76666667,
       4.        ]) use_patch_mixer=True patch_mixer_depth=4 patch_mixer_dim=512 patch_mixer_qkv_ratio=1.0 patch_mixer_mlp_ratio=4.0 use_bias=False num_experts=8 expert_capacity=2.0 experts_every_n=2
ğŸŸ¦ self.base_size=16
ğŸŸ© CaptionProjectionã‚’åˆæœŸåŒ– in_channels=1024 hidden_size=512 act_layer=<function DiT.__init__.<locals>.<lambda> at 0x7e4457605940> norm_layer=LayerNorm((512,), eps=1e-06, elementwise_affine=True)
ğŸŸ© MLPã‚’åˆæœŸåŒ– in_features=1024 hidden_features=512 out_features=512 act_layer=<function DiT.__init__.<locals>.<lambda> at 0x7e4457605940> norm_layer=LayerNorm((512,), eps=1e-06, elementwise_affine=True) bias=True
ğŸŸ© AttentionBlockPromptEmbeddingã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=4.0 multiple_of=256 norm_eps=1e-06 use_bias=False
ğŸŸ¦ self.num_heads=16
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=None
ğŸŸ¦ self.head_dim=32
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=2048 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1365
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1536
ğŸŸ© MLPã‚’åˆæœŸåŒ– in_features=512 hidden_features=512 out_features=512 act_layer=<function DiT.__init__.<locals>.<lambda> at 0x7e4457605940> norm_layer=LayerNorm((512,), eps=1e-06, elementwise_affine=True) bias=True
ğŸŸ¦ expert_blocks_idx=[1, 3]
ğŸŸ¦ is_moe_block=[False, True, False, True]
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=4.0 qkv_ratio=1.0 multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=False layer_id=0 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=2048
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=2048 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1365
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1536
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=4.0 qkv_ratio=1.0 multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=False layer_id=0 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=2048
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=2048 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=4.0 qkv_ratio=1.0 multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=False layer_id=0 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=2048
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=2048 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1365
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1536
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=4.0 qkv_ratio=1.0 multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=False layer_id=0 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=2048
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=2048 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(0.5) qkv_ratio=np.float64(0.5) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=0 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=256
ğŸŸ¦ mlp_hidden_dim=256
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=8 qkv_bias=False norm_eps=1e-06 hidden_dim=256
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=256 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=170
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(0.7333333333333334) qkv_ratio=np.float64(0.5333333333333333) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=1 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=320
ğŸŸ¦ mlp_hidden_dim=375
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=10 qkv_bias=False norm_eps=1e-06 hidden_dim=320
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=375 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(0.9666666666666667) qkv_ratio=np.float64(0.5666666666666667) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=2 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=320
ğŸŸ¦ mlp_hidden_dim=494
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=10 qkv_bias=False norm_eps=1e-06 hidden_dim=320
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=494 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=329
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=512
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(1.2) qkv_ratio=np.float64(0.6) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=3 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=320
ğŸŸ¦ mlp_hidden_dim=614
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=10 qkv_bias=False norm_eps=1e-06 hidden_dim=320
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=614 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(1.4333333333333333) qkv_ratio=np.float64(0.6333333333333333) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=4 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=384
ğŸŸ¦ mlp_hidden_dim=733
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=12 qkv_bias=False norm_eps=1e-06 hidden_dim=384
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=733 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=488
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=512
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(1.6666666666666667) qkv_ratio=np.float64(0.6666666666666666) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=5 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=384
ğŸŸ¦ mlp_hidden_dim=853
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=12 qkv_bias=False norm_eps=1e-06 hidden_dim=384
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=853 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(1.9) qkv_ratio=np.float64(0.7) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=6 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=384
ğŸŸ¦ mlp_hidden_dim=972
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=12 qkv_bias=False norm_eps=1e-06 hidden_dim=384
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=972 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=648
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=768
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(2.1333333333333333) qkv_ratio=np.float64(0.7333333333333334) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=7 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=384
ğŸŸ¦ mlp_hidden_dim=1092
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=12 qkv_bias=False norm_eps=1e-06 hidden_dim=384
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=1092 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(2.3666666666666667) qkv_ratio=np.float64(0.7666666666666666) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=8 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=448
ğŸŸ¦ mlp_hidden_dim=1211
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=14 qkv_bias=False norm_eps=1e-06 hidden_dim=448
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=1211 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=807
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1024
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(2.6) qkv_ratio=np.float64(0.8) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=9 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=448
ğŸŸ¦ mlp_hidden_dim=1331
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=14 qkv_bias=False norm_eps=1e-06 hidden_dim=448
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=1331 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(2.8333333333333335) qkv_ratio=np.float64(0.8333333333333333) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=10 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=448
ğŸŸ¦ mlp_hidden_dim=1450
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=14 qkv_bias=False norm_eps=1e-06 hidden_dim=448
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=1450 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=966
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1024
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(3.066666666666667) qkv_ratio=np.float64(0.8666666666666667) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=11 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=448
ğŸŸ¦ mlp_hidden_dim=1570
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=14 qkv_bias=False norm_eps=1e-06 hidden_dim=448
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=2e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=1570 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(3.3) qkv_ratio=np.float64(0.9) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=12 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=1689
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=1689 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1126
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1280
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(3.533333333333333) qkv_ratio=np.float64(0.9333333333333333) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=13 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=1809
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=1809 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(3.7666666666666666) qkv_ratio=np.float64(0.9666666666666667) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=14 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=1928
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=1928 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1285
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1536
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(4.0) qkv_ratio=np.float64(1.0) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=15 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=2048
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=2048 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1365
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1536
ğŸŸ© T2IFinalLayerã‚’åˆæœŸåŒ– hidden_size=512 time_emb_dim=512 patch_size=2 out_channels=4 act_layer=<function DiT.__init__.<locals>.<lambda> at 0x7e4457605940> norm_final=LayerNorm((512,), eps=1e-06, elementwise_affine=True)
ğŸŸ© é‡ã¿ã®åˆæœŸåŒ–ã‚’å®Ÿè¡Œ
ğŸŸ© 2Dæ­£å¼¦æ³¢ä½ç½®åŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆ embed_dim=512 grid_size=16 cls_token=False extra_tokens=0 pos_interp_scale=1.0 base_size=16
ğŸŸ© 2Dæ­£å¼¦æ³¢ä½ç½®åŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆ embed_dim=512 grid.shape=(2, 1, 16, 16)
ğŸŸ© 1Dæ­£å¼¦æ³¢ä½ç½®åŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆ embed_dim=256 pos.shape=(1, 16, 16)
ğŸŸ¦ ä½ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ reshaped pos.shape=(256,)
ğŸŸ¦ ä½ç½®ã¨å‘¨æ³¢æ•°ã®ç© out.shape=(256, 128)
ğŸŸ¦ æ°´å¹³ä½ç½®åŸ‹ã‚è¾¼ã¿ emb_h.shape=(256, 256)
ğŸŸ© 1Dæ­£å¼¦æ³¢ä½ç½®åŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆ embed_dim=256 pos.shape=(1, 16, 16)
ğŸŸ¦ ä½ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ reshaped pos.shape=(256,)
ğŸŸ¦ ä½ç½®ã¨å‘¨æ³¢æ•°ã®ç© out.shape=(256, 128)
ğŸŸ¦ å‚ç›´ä½ç½®åŸ‹ã‚è¾¼ã¿ emb_w.shape=(256, 256)
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.014142135623730949
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.014142135623730949
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.014142135623730949
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.01
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.01
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.01
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.008164965809277261
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.008164965809277261
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.008164965809277261
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0070710678118654745
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0070710678118654745
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0070710678118654745
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.006324555320336759
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.006324555320336759
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.006324555320336759
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005773502691896258
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005773502691896258
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005773502691896258
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005345224838248488
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005345224838248488
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005345224838248488
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0047140452079103175
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0047140452079103175
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0047140452079103175
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004472135954999579
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004472135954999579
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004472135954999579
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004264014327112209
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004264014327112209
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004264014327112209
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004082482904638631
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004082482904638631
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004082482904638631
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003922322702763681
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003922322702763681
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003922322702763681
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003779644730092272
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003779644730092272
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003779644730092272
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0036514837167011074
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0036514837167011074
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0036514837167011074
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© AttentionBlockPromptEmbeddingã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.02
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.02
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.02
ğŸŸ© DiTã®é †ä¼æ’­ï¼ˆCFGã‚ã‚Šï¼‰ x.shape=torch.Size([1, 4, 32, 32]) t.shape=torch.Size([1]) y.shape=torch.Size([1, 1, 16, 1024]) cfg=1.5 mask_ratio=0.3
ğŸŸ¦ CFGç”¨ã«ãƒãƒƒãƒã‚’2å€ã«æ‹¡å¼µ x.shape=torch.Size([2, 4, 32, 32])
ğŸŸ¦ CFGç”¨ã«ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³åŸ‹ã‚è¾¼ã¿ã‚’æ‹¡å¼µ y.shape=torch.Size([2, 1, 16, 1024])
ğŸŸ© DiTã®é †ä¼æ’­ï¼ˆCFGãªã—ï¼‰ x.shape=torch.Size([2, 4, 32, 32]) t.shape=torch.Size([1]) y.shape=torch.Size([2, 1, 16, 1024]) mask_ratio=0.3
ğŸŸ¦ self.h=16
ğŸŸ¦ self.w=16
ğŸŸ¦ ãƒ‘ãƒƒãƒåŸ‹ã‚è¾¼ã¿å¾Œã®ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 256, 512])
ğŸŸ¦ ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—åŸ‹ã‚è¾¼ã¿ã®é †ä¼æ’­ t.shape=torch.Size([2])
ğŸŸ© ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—åŸ‹ã‚è¾¼ã¿ã‚’ä½œæˆ t.shape=torch.Size([2]) dim=512 max_period=10000
ğŸŸ¦ freqs=tensor([1.0000e+00, 9.6466e-01, 9.3057e-01, 8.9769e-01, 8.6596e-01, 8.3536e-01,
        8.0584e-01, 7.7737e-01, 7.4989e-01, 7.2339e-01, 6.9783e-01, 6.7317e-01,
        6.4938e-01, 6.2643e-01, 6.0430e-01, 5.8294e-01, 5.6234e-01, 5.4247e-01,
        5.2330e-01, 5.0481e-01, 4.8697e-01, 4.6976e-01, 4.5316e-01, 4.3714e-01,
        4.2170e-01, 4.0679e-01, 3.9242e-01, 3.7855e-01, 3.6517e-01, 3.5227e-01,
        3.3982e-01, 3.2781e-01, 3.1623e-01, 3.0505e-01, 2.9427e-01, 2.8387e-01,
        2.7384e-01, 2.6416e-01, 2.5483e-01, 2.4582e-01, 2.3714e-01, 2.2876e-01,
        2.2067e-01, 2.1288e-01, 2.0535e-01, 1.9810e-01, 1.9110e-01, 1.8434e-01,
        1.7783e-01, 1.7154e-01, 1.6548e-01, 1.5963e-01, 1.5399e-01, 1.4855e-01,
        1.4330e-01, 1.3824e-01, 1.3335e-01, 1.2864e-01, 1.2409e-01, 1.1971e-01,
        1.1548e-01, 1.1140e-01, 1.0746e-01, 1.0366e-01, 1.0000e-01, 9.6466e-02,
        9.3057e-02, 8.9769e-02, 8.6596e-02, 8.3536e-02, 8.0584e-02, 7.7736e-02,
        7.4989e-02, 7.2339e-02, 6.9783e-02, 6.7317e-02, 6.4938e-02, 6.2643e-02,
        6.0430e-02, 5.8294e-02, 5.6234e-02, 5.4247e-02, 5.2330e-02, 5.0481e-02,
        4.8697e-02, 4.6976e-02, 4.5316e-02, 4.3714e-02, 4.2170e-02, 4.0679e-02,
        3.9242e-02, 3.7855e-02, 3.6517e-02, 3.5227e-02, 3.3982e-02, 3.2781e-02,
        3.1623e-02, 3.0505e-02, 2.9427e-02, 2.8387e-02, 2.7384e-02, 2.6416e-02,
        2.5483e-02, 2.4582e-02, 2.3714e-02, 2.2876e-02, 2.2067e-02, 2.1288e-02,
        2.0535e-02, 1.9810e-02, 1.9110e-02, 1.8434e-02, 1.7783e-02, 1.7154e-02,
        1.6548e-02, 1.5963e-02, 1.5399e-02, 1.4855e-02, 1.4330e-02, 1.3824e-02,
        1.3335e-02, 1.2864e-02, 1.2409e-02, 1.1971e-02, 1.1548e-02, 1.1140e-02,
        1.0746e-02, 1.0366e-02, 1.0000e-02, 9.6466e-03, 9.3057e-03, 8.9769e-03,
        8.6596e-03, 8.3536e-03, 8.0584e-03, 7.7736e-03, 7.4989e-03, 7.2339e-03,
        6.9783e-03, 6.7317e-03, 6.4938e-03, 6.2643e-03, 6.0430e-03, 5.8294e-03,
        5.6234e-03, 5.4247e-03, 5.2330e-03, 5.0481e-03, 4.8697e-03, 4.6976e-03,
        4.5316e-03, 4.3714e-03, 4.2170e-03, 4.0679e-03, 3.9242e-03, 3.7855e-03,
        3.6517e-03, 3.5227e-03, 3.3982e-03, 3.2781e-03, 3.1623e-03, 3.0505e-03,
        2.9427e-03, 2.8387e-03, 2.7384e-03, 2.6416e-03, 2.5483e-03, 2.4582e-03,
        2.3714e-03, 2.2876e-03, 2.2067e-03, 2.1288e-03, 2.0535e-03, 1.9810e-03,
        1.9110e-03, 1.8434e-03, 1.7783e-03, 1.7154e-03, 1.6548e-03, 1.5963e-03,
        1.5399e-03, 1.4855e-03, 1.4330e-03, 1.3824e-03, 1.3335e-03, 1.2864e-03,
        1.2409e-03, 1.1971e-03, 1.1548e-03, 1.1140e-03, 1.0746e-03, 1.0366e-03,
        1.0000e-03, 9.6466e-04, 9.3057e-04, 8.9769e-04, 8.6596e-04, 8.3536e-04,
        8.0584e-04, 7.7736e-04, 7.4989e-04, 7.2339e-04, 6.9783e-04, 6.7317e-04,
        6.4938e-04, 6.2643e-04, 6.0430e-04, 5.8294e-04, 5.6234e-04, 5.4247e-04,
        5.2330e-04, 5.0481e-04, 4.8697e-04, 4.6976e-04, 4.5316e-04, 4.3714e-04,
        4.2170e-04, 4.0679e-04, 3.9242e-04, 3.7855e-04, 3.6517e-04, 3.5227e-04,
        3.3982e-04, 3.2781e-04, 3.1623e-04, 3.0505e-04, 2.9427e-04, 2.8387e-04,
        2.7384e-04, 2.6416e-04, 2.5483e-04, 2.4582e-04, 2.3714e-04, 2.2876e-04,
        2.2067e-04, 2.1288e-04, 2.0535e-04, 1.9810e-04, 1.9110e-04, 1.8434e-04,
        1.7783e-04, 1.7154e-04, 1.6548e-04, 1.5963e-04, 1.5399e-04, 1.4855e-04,
        1.4330e-04, 1.3824e-04, 1.3335e-04, 1.2864e-04, 1.2409e-04, 1.1971e-04,
        1.1548e-04, 1.1140e-04, 1.0746e-04, 1.0366e-04])
ğŸŸ¦ ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—åŸ‹ã‚è¾¼ã¿ãƒ†ãƒ³ã‚½ãƒ« embedding.shape=torch.Size([2, 512])
ğŸŸ¦ ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—åŸ‹ã‚è¾¼ã¿å¾Œã®ãƒ†ãƒ³ã‚½ãƒ« t.shape=torch.Size([2, 512])
ğŸŸ© CaptionProjectionã®é †ä¼æ’­ caption.shape=torch.Size([2, 1, 16, 1024])
ğŸŸ¦ MLPã®é †ä¼æ’­ x.shape=torch.Size([2, 1, 16, 1024])
ğŸŸ¦ MLP fc1å¾Œ x.shape=torch.Size([2, 1, 16, 512])
ğŸŸ¦ MLP fc2å¾Œ x.shape=torch.Size([2, 1, 16, 512])
ğŸŸ¦ å¤‰æ›å¾Œã®ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ãƒ†ãƒ³ã‚½ãƒ« result.shape=torch.Size([2, 1, 16, 512])
ğŸŸ¦ ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³åŸ‹ã‚è¾¼ã¿å¾Œã®ãƒ†ãƒ³ã‚½ãƒ« y.shape=torch.Size([2, 1, 16, 512])
ğŸŸ© AttentionBlockPromptEmbeddingã®é †ä¼æ’­ x.shape=torch.Size([2, 16, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 16, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 16, 512])
ğŸŸ¦ å‰å‡¦ç†å¾Œã®ãƒ†ã‚­ã‚¹ãƒˆåŸ‹ã‚è¾¼ã¿ãƒ†ãƒ³ã‚½ãƒ« y.shape=torch.Size([2, 1, 16, 512])
ğŸŸ¦ MLPã®é †ä¼æ’­ x.shape=torch.Size([2, 512])
ğŸŸ¦ MLP fc1å¾Œ x.shape=torch.Size([2, 512])
ğŸŸ¦ MLP fc2å¾Œ x.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒ†ã‚­ã‚¹ãƒˆåŸ‹ã‚è¾¼ã¿ã‚’åŠ ç®—å¾Œã®ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—ãƒ†ãƒ³ã‚½ãƒ« t.shape=torch.Size([2, 512])
ğŸŸ¦ Patch-Mixerå…¥åŠ›ãƒãƒƒãƒ”ãƒ³ã‚°å¾Œã®ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 256, 512])
ğŸŸ¦ Patch-Mixerãƒ†ã‚­ã‚¹ãƒˆåŸ‹ã‚è¾¼ã¿ãƒãƒƒãƒ”ãƒ³ã‚°å¾Œã®ãƒ†ãƒ³ã‚½ãƒ« y_mixer.shape=torch.Size([2, 1, 16, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 256, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512])
ğŸŸ© FeedForwardECMoeã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512])
ğŸŸ¦ tokens_per_expert=64
ğŸŸ¦ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒã‚¹ã‚¯ p.shape=torch.Size([2, 8, 64, 256])
ğŸŸ¦ å°‚é–€å®¶ã¸ã®åˆ†é… xin.shape=torch.Size([2, 8, 64, 512])
ğŸŸ¦ å°‚é–€å®¶ã®æœ€åˆã®ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 64, 2048])
ğŸŸ¦ å°‚é–€å®¶ã®å‡ºåŠ›ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 64, 512])
ğŸŸ¦ é‡ã¿ä»˜ã‘å¾Œ out.shape=torch.Size([2, 8, 64, 512])
ğŸŸ¦ æœ€çµ‚å‡ºåŠ› out.shape=torch.Size([2, 256, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 256, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 256, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512])
ğŸŸ© FeedForwardECMoeã®é †ä¼æ’­ x.shape=torch.Size([2, 256, 512])
ğŸŸ¦ tokens_per_expert=64
ğŸŸ¦ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒã‚¹ã‚¯ p.shape=torch.Size([2, 8, 64, 256])
ğŸŸ¦ å°‚é–€å®¶ã¸ã®åˆ†é… xin.shape=torch.Size([2, 8, 64, 512])
ğŸŸ¦ å°‚é–€å®¶ã®æœ€åˆã®ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 64, 2048])
ğŸŸ¦ å°‚é–€å®¶ã®å‡ºåŠ›ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 64, 512])
ğŸŸ¦ é‡ã¿ä»˜ã‘å¾Œ out.shape=torch.Size([2, 8, 64, 512])
ğŸŸ¦ æœ€çµ‚å‡ºåŠ› out.shape=torch.Size([2, 256, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 256, 512])
ğŸŸ¦ Patch-Mixeré©ç”¨å¾Œã®ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 256, 512])
ğŸŸ© ãƒã‚¹ã‚¯ã‚’ç”Ÿæˆ batch=2 length=256 mask_ratio=0.3 device=device(type='cpu')
ğŸŸ¦ len_keep=179
ğŸŸ© ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒã‚¹ã‚¯ã‚¢ã‚¦ãƒˆ x.shape=torch.Size([2, 256, 512]) ids_keep.shape=torch.Size([2, 179])
ğŸŸ¦ ãƒã‚¹ã‚¯å¾Œã®ãƒ†ãƒ³ã‚½ãƒ« x_masked.shape=torch.Size([2, 179, 512])
ğŸŸ¦ ãƒã‚¹ã‚¯ã‚¢ã‚¦ãƒˆå¾Œã®ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ© FeedForwardECMoeã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ tokens_per_expert=44
ğŸŸ¦ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒã‚¹ã‚¯ p.shape=torch.Size([2, 8, 44, 179])
ğŸŸ¦ å°‚é–€å®¶ã¸ã®åˆ†é… xin.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ å°‚é–€å®¶ã®æœ€åˆã®ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ å°‚é–€å®¶ã®å‡ºåŠ›ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ é‡ã¿ä»˜ã‘å¾Œ out.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ æœ€çµ‚å‡ºåŠ› out.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ© FeedForwardECMoeã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ tokens_per_expert=44
ğŸŸ¦ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒã‚¹ã‚¯ p.shape=torch.Size([2, 8, 44, 179])
ğŸŸ¦ å°‚é–€å®¶ã¸ã®åˆ†é… xin.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ å°‚é–€å®¶ã®æœ€åˆã®ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 768])
ğŸŸ¦ å°‚é–€å®¶ã®å‡ºåŠ›ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ é‡ã¿ä»˜ã‘å¾Œ out.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ æœ€çµ‚å‡ºåŠ› out.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ© FeedForwardECMoeã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ tokens_per_expert=44
ğŸŸ¦ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒã‚¹ã‚¯ p.shape=torch.Size([2, 8, 44, 179])
ğŸŸ¦ å°‚é–€å®¶ã¸ã®åˆ†é… xin.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ å°‚é–€å®¶ã®æœ€åˆã®ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 1024])
ğŸŸ¦ å°‚é–€å®¶ã®å‡ºåŠ›ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ é‡ã¿ä»˜ã‘å¾Œ out.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ æœ€çµ‚å‡ºåŠ› out.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ© FeedForwardECMoeã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ tokens_per_expert=44
ğŸŸ¦ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒã‚¹ã‚¯ p.shape=torch.Size([2, 8, 44, 179])
ğŸŸ¦ å°‚é–€å®¶ã¸ã®åˆ†é… xin.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ å°‚é–€å®¶ã®æœ€åˆã®ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 1280])
ğŸŸ¦ å°‚é–€å®¶ã®å‡ºåŠ›ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ é‡ã¿ä»˜ã‘å¾Œ out.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ æœ€çµ‚å‡ºåŠ› out.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ© FeedForwardECMoeã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ tokens_per_expert=44
ğŸŸ¦ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒã‚¹ã‚¯ p.shape=torch.Size([2, 8, 44, 179])
ğŸŸ¦ å°‚é–€å®¶ã¸ã®åˆ†é… xin.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ å°‚é–€å®¶ã®æœ€åˆã®ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 1536])
ğŸŸ¦ å°‚é–€å®¶ã®å‡ºåŠ›ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ é‡ã¿ä»˜ã‘å¾Œ out.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ æœ€çµ‚å‡ºåŠ› out.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ© FeedForwardECMoeã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ tokens_per_expert=44
ğŸŸ¦ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒã‚¹ã‚¯ p.shape=torch.Size([2, 8, 44, 179])
ğŸŸ¦ å°‚é–€å®¶ã¸ã®åˆ†é… xin.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ å°‚é–€å®¶ã®æœ€åˆã®ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 1792])
ğŸŸ¦ å°‚é–€å®¶ã®å‡ºåŠ›ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ é‡ã¿ä»˜ã‘å¾Œ out.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ æœ€çµ‚å‡ºåŠ› out.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ© FeedForwardECMoeã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ tokens_per_expert=44
ğŸŸ¦ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒã‚¹ã‚¯ p.shape=torch.Size([2, 8, 44, 179])
ğŸŸ¦ å°‚é–€å®¶ã¸ã®åˆ†é… xin.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ å°‚é–€å®¶ã®æœ€åˆã®ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 2048])
ğŸŸ¦ å°‚é–€å®¶ã®å‡ºåŠ›ç·šå½¢å±¤å¾Œ h.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ é‡ã¿ä»˜ã‘å¾Œ out.shape=torch.Size([2, 8, 44, 512])
ğŸŸ¦ æœ€çµ‚å‡ºåŠ› out.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© DiTBlockã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) y.shape=torch.Size([2, 1, 16, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ shift_msa.shape=torch.Size([2, 512]) scale_msa.shape=torch.Size([2, 512]) gate_msa.shape=torch.Size([2, 512]) shift_mlp.shape=torch.Size([2, 512]) scale_mlp.shape=torch.Size([2, 512]) gate_mlp.shape=torch.Size([2, 512])
ğŸŸ¦ ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ FeedForwardã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512])
ğŸŸ¦ DiTBlockå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 512])
ğŸŸ© T2IFinalLayerã®é †ä¼æ’­ x.shape=torch.Size([2, 179, 512]) c.shape=torch.Size([2, 512])
ğŸŸ¦ T2IFinalLayerå‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 16])
ğŸŸ¦ æœ€çµ‚å‡ºåŠ›å±¤é©ç”¨å¾Œã®ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 179, 16])
ğŸŸ© ãƒã‚¹ã‚¯ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è£œå®Œã—ã¦å…ƒã®é †åºã‚’å¾©å…ƒ x.shape=torch.Size([2, 179, 16]) ids_restore.shape=torch.Size([2, 256]) mask_token.shape=torch.Size([1, 1, 16])
ğŸŸ¦ è£œå®Œç”¨ãƒã‚¹ã‚¯ãƒˆãƒ¼ã‚¯ãƒ³ãƒ†ãƒ³ã‚½ãƒ« mask_tokens.shape=torch.Size([2, 77, 16])
ğŸŸ¦ ãƒã‚¹ã‚¯ãƒˆãƒ¼ã‚¯ãƒ³ã‚’é€£çµå¾Œã®ãƒ†ãƒ³ã‚½ãƒ« x_.shape=torch.Size([2, 256, 16])
ğŸŸ© ãƒ‘ãƒƒãƒã‚’å…ƒã®ç”»åƒã«å¾©å…ƒ x.shape=torch.Size([2, 256, 16])
ğŸŸ¦ c=4
ğŸŸ¦ p=2
ğŸŸ¦ h=16 w=16
ğŸŸ¦ ãƒ‘ãƒƒãƒã‚’æ­£ã—ã„ä½ç½®ã«é…ç½®å¾Œã®ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 4, 16, 2, 16, 2])
ğŸŸ¦ å¾©å…ƒã•ã‚ŒãŸç”»åƒãƒ†ãƒ³ã‚½ãƒ« result.shape=torch.Size([2, 4, 32, 32])
ğŸŸ¦ ãƒ‘ãƒƒãƒå†æ§‹æˆå¾Œã®ãƒ†ãƒ³ã‚½ãƒ« x.shape=torch.Size([2, 4, 32, 32])
ğŸŸ¦ æ¡ä»¶ä»˜ãã¨ç„¡æ¡ä»¶ã®å‡ºåŠ›ã«åˆ†å‰² cond_eps.shape=torch.Size([1, 4, 32, 32]) uncond_eps.shape=torch.Size([1, 4, 32, 32])
ğŸŸ¦ CFGã‚’é©ç”¨ã—ãŸæœ€çµ‚å‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« eps.shape=torch.Size([1, 4, 32, 32])
ğŸŸ© MicroDiT_Tiny_2ã®å‡ºåŠ›ãƒ†ãƒ³ã‚½ãƒ« output['sample'].shape=torch.Size([1, 4, 32, 32])
ğŸŸ© Latent Diffusionãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆ: vae_name='stabilityai/stable-diffusion-xl-base-1.0', text_encoder_name='openclip:hf-hub:apple/DFN5B-CLIP-ViT-H-14-378', dit_arch='MicroDiT_Tiny_2', latent_res=32, in_channels=4, pos_interp_scale=1.0, dtype='bfloat16', precomputed_latents=True, p_mean=-0.6, p_std=1.2, train_mask_ratio=0.75
ğŸŸ© DiTã‚’åˆæœŸåŒ– input_size=32 patch_size=2 in_channels=4 dim=512 depth=16 head_dim=32 multiple_of=256 caption_channels=1024 pos_interp_scale=1.0 norm_eps=1e-06 depth_init=True qkv_multipliers=array([0.5       , 0.53333333, 0.56666667, 0.6       , 0.63333333,
       0.66666667, 0.7       , 0.73333333, 0.76666667, 0.8       ,
       0.83333333, 0.86666667, 0.9       , 0.93333333, 0.96666667,
       1.        ]) ffn_multipliers=array([0.5       , 0.73333333, 0.96666667, 1.2       , 1.43333333,
       1.66666667, 1.9       , 2.13333333, 2.36666667, 2.6       ,
       2.83333333, 3.06666667, 3.3       , 3.53333333, 3.76666667,
       4.        ]) use_patch_mixer=True patch_mixer_depth=4 patch_mixer_dim=512 patch_mixer_qkv_ratio=1.0 patch_mixer_mlp_ratio=4.0 use_bias=False num_experts=8 expert_capacity=2.0 experts_every_n=2
ğŸŸ¦ self.base_size=16
ğŸŸ© CaptionProjectionã‚’åˆæœŸåŒ– in_channels=1024 hidden_size=512 act_layer=<function DiT.__init__.<locals>.<lambda> at 0x7e44571f7b00> norm_layer=LayerNorm((512,), eps=1e-06, elementwise_affine=True)
ğŸŸ© MLPã‚’åˆæœŸåŒ– in_features=1024 hidden_features=512 out_features=512 act_layer=<function DiT.__init__.<locals>.<lambda> at 0x7e44571f7b00> norm_layer=LayerNorm((512,), eps=1e-06, elementwise_affine=True) bias=True
ğŸŸ© AttentionBlockPromptEmbeddingã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=4.0 multiple_of=256 norm_eps=1e-06 use_bias=False
ğŸŸ¦ self.num_heads=16
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=None
ğŸŸ¦ self.head_dim=32
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=2048 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1365
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1536
ğŸŸ© MLPã‚’åˆæœŸåŒ– in_features=512 hidden_features=512 out_features=512 act_layer=<function DiT.__init__.<locals>.<lambda> at 0x7e44571f7b00> norm_layer=LayerNorm((512,), eps=1e-06, elementwise_affine=True) bias=True
ğŸŸ¦ expert_blocks_idx=[1, 3]
ğŸŸ¦ is_moe_block=[False, True, False, True]
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=4.0 qkv_ratio=1.0 multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=False layer_id=0 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=2048
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=2048 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1365
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1536
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=4.0 qkv_ratio=1.0 multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=False layer_id=0 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=2048
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=2048 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=4.0 qkv_ratio=1.0 multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=False layer_id=0 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=2048
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=2048 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1365
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1536
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=4.0 qkv_ratio=1.0 multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=False layer_id=0 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=2048
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=2048 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(0.5) qkv_ratio=np.float64(0.5) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=0 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=256
ğŸŸ¦ mlp_hidden_dim=256
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=8 qkv_bias=False norm_eps=1e-06 hidden_dim=256
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=256 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=170
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(0.7333333333333334) qkv_ratio=np.float64(0.5333333333333333) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=1 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=320
ğŸŸ¦ mlp_hidden_dim=375
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=10 qkv_bias=False norm_eps=1e-06 hidden_dim=320
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=375 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(0.9666666666666667) qkv_ratio=np.float64(0.5666666666666667) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=2 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=320
ğŸŸ¦ mlp_hidden_dim=494
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=10 qkv_bias=False norm_eps=1e-06 hidden_dim=320
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=494 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=329
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=512
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(1.2) qkv_ratio=np.float64(0.6) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=3 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=320
ğŸŸ¦ mlp_hidden_dim=614
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=10 qkv_bias=False norm_eps=1e-06 hidden_dim=320
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=614 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(1.4333333333333333) qkv_ratio=np.float64(0.6333333333333333) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=4 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=384
ğŸŸ¦ mlp_hidden_dim=733
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=12 qkv_bias=False norm_eps=1e-06 hidden_dim=384
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=733 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=488
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=512
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(1.6666666666666667) qkv_ratio=np.float64(0.6666666666666666) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=5 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=384
ğŸŸ¦ mlp_hidden_dim=853
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=12 qkv_bias=False norm_eps=1e-06 hidden_dim=384
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=853 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(1.9) qkv_ratio=np.float64(0.7) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=6 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=384
ğŸŸ¦ mlp_hidden_dim=972
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=12 qkv_bias=False norm_eps=1e-06 hidden_dim=384
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=972 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=648
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=768
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(2.1333333333333333) qkv_ratio=np.float64(0.7333333333333334) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=7 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=384
ğŸŸ¦ mlp_hidden_dim=1092
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=12 qkv_bias=False norm_eps=1e-06 hidden_dim=384
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=1092 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(2.3666666666666667) qkv_ratio=np.float64(0.7666666666666666) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=8 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=448
ğŸŸ¦ mlp_hidden_dim=1211
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=14 qkv_bias=False norm_eps=1e-06 hidden_dim=448
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=1211 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=807
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1024
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(2.6) qkv_ratio=np.float64(0.8) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=9 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=448
ğŸŸ¦ mlp_hidden_dim=1331
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=14 qkv_bias=False norm_eps=1e-06 hidden_dim=448
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=1331 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(2.8333333333333335) qkv_ratio=np.float64(0.8333333333333333) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=10 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=448
ğŸŸ¦ mlp_hidden_dim=1450
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=14 qkv_bias=False norm_eps=1e-06 hidden_dim=448
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=1450 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=966
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1024
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(3.066666666666667) qkv_ratio=np.float64(0.8666666666666667) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=11 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=448
ğŸŸ¦ mlp_hidden_dim=1570
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=14 qkv_bias=False norm_eps=1e-06 hidden_dim=448
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=1570 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(3.3) qkv_ratio=np.float64(0.9) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=12 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=1689
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=1689 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1126
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1280
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(3.533333333333333) qkv_ratio=np.float64(0.9333333333333333) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=13 num_layers=16 compress_xattn=False use_bias=False moe_block=True num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=1809
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardECMoeã‚’åˆæœŸåŒ– num_experts=8 expert_capacity=2.0 dim=512 hidden_dim=1809 multiple_of=256
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(3.7666666666666666) qkv_ratio=np.float64(0.9666666666666667) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=14 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=1928
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=1928 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1285
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1536
ğŸŸ© DiTBlockã‚’åˆæœŸåŒ– dim=512 head_dim=32 mlp_ratio=np.float64(4.0) qkv_ratio=np.float64(1.0) multiple_of=256 pooled_emb_dim=512 norm_eps=1e-06 depth_init=True layer_id=15 num_layers=16 compress_xattn=False use_bias=False moe_block=False num_experts=8 expert_capacity=2.0
ğŸŸ¦ qkv_hidden_dim=512
ğŸŸ¦ mlp_hidden_dim=2048
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚»ãƒ«ãƒ•ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ¦ self.head_dim=32
ğŸŸ© ãƒãƒ«ãƒãƒ˜ãƒƒãƒ‰ã‚¯ãƒ­ã‚¹ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ– dim=512 num_heads=16 qkv_bias=False norm_eps=1e-06 hidden_dim=512
ğŸŸ© FeedForwardãƒ–ãƒ­ãƒƒã‚¯ã‚’åˆæœŸåŒ– dim=512 hidden_dim=2048 multiple_of=256 use_bias=False
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å‰ hidden_dim=1365
ğŸŸ¦ FeedForwardéš ã‚Œæ¬¡å…ƒèª¿æ•´å¾Œ self.hidden_dim=1536
ğŸŸ© T2IFinalLayerã‚’åˆæœŸåŒ– hidden_size=512 time_emb_dim=512 patch_size=2 out_channels=4 act_layer=<function DiT.__init__.<locals>.<lambda> at 0x7e44571f7b00> norm_final=LayerNorm((512,), eps=1e-06, elementwise_affine=True)
ğŸŸ© é‡ã¿ã®åˆæœŸåŒ–ã‚’å®Ÿè¡Œ
ğŸŸ© 2Dæ­£å¼¦æ³¢ä½ç½®åŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆ embed_dim=512 grid_size=16 cls_token=False extra_tokens=0 pos_interp_scale=1.0 base_size=16
ğŸŸ© 2Dæ­£å¼¦æ³¢ä½ç½®åŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆ embed_dim=512 grid.shape=(2, 1, 16, 16)
ğŸŸ© 1Dæ­£å¼¦æ³¢ä½ç½®åŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆ embed_dim=256 pos.shape=(1, 16, 16)
ğŸŸ¦ ä½ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ reshaped pos.shape=(256,)
ğŸŸ¦ ä½ç½®ã¨å‘¨æ³¢æ•°ã®ç© out.shape=(256, 128)
ğŸŸ¦ æ°´å¹³ä½ç½®åŸ‹ã‚è¾¼ã¿ emb_h.shape=(256, 256)
ğŸŸ© 1Dæ­£å¼¦æ³¢ä½ç½®åŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆ embed_dim=256 pos.shape=(1, 16, 16)
ğŸŸ¦ ä½ç½®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ reshaped pos.shape=(256,)
ğŸŸ¦ ä½ç½®ã¨å‘¨æ³¢æ•°ã®ç© out.shape=(256, 128)
ğŸŸ¦ å‚ç›´ä½ç½®åŸ‹ã‚è¾¼ã¿ emb_w.shape=(256, 256)
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.014142135623730949
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.014142135623730949
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.014142135623730949
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.01
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.01
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.01
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.008164965809277261
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.008164965809277261
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.008164965809277261
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0070710678118654745
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0070710678118654745
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0070710678118654745
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.006324555320336759
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.006324555320336759
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.006324555320336759
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005773502691896258
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005773502691896258
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005773502691896258
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005345224838248488
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005345224838248488
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005345224838248488
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.005
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0047140452079103175
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0047140452079103175
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0047140452079103175
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004472135954999579
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004472135954999579
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004472135954999579
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004264014327112209
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004264014327112209
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004264014327112209
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004082482904638631
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004082482904638631
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.004082482904638631
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003922322702763681
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003922322702763681
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003922322702763681
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003779644730092272
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003779644730092272
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.003779644730092272
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0036514837167011074
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0036514837167011074
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0036514837167011074
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© DiTBlockã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© CrossAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© FeedForwardECMoeã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.0035355339059327372
ğŸŸ© AttentionBlockPromptEmbeddingã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.02
ğŸŸ© SelfAttentionã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.02
ğŸŸ© FeedForwardã®é‡ã¿ã‚’ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ– init_std=0.02
ğŸŸ© UniversalTextEncoderã‚’åˆæœŸåŒ–: name='openclip:hf-hub:apple/DFN5B-CLIP-ViT-H-14-378', dtype='bfloat16', pretrained=True
ğŸŸ© Parsing model identifier. Schema: hf-hub, Identifier: apple/DFN5B-CLIP-ViT-H-14-378
ğŸŸ© Attempting to load config from HF Hub: apple/DFN5B-CLIP-ViT-H-14-378
ğŸŸ© Loaded model config from HF Hub: apple/DFN5B-CLIP-ViT-H-14-378
ğŸŸ© Found default weights file on HF Hub: /root/.cache/huggingface/hub/models--apple--DFN5B-CLIP-ViT-H-14-378/snapshots/01b771ed0d1395ca5ffdd279897d665ebe00dfd2/open_clip_pytorch_model.bin
ğŸŸ© Instantiating model architecture: CLIP
ğŸŸ© Loading full pretrained weights from: /root/.cache/huggingface/hub/models--apple--DFN5B-CLIP-ViT-H-14-378/snapshots/01b771ed0d1395ca5ffdd279897d665ebe00dfd2/open_clip_pytorch_model.bin
ğŸŸ© Final image preprocessing configuration set: {'size': (378, 378), 'mode': 'RGB', 'mean': [0.48145466, 0.4578275, 0.40821073], 'std': [0.26862954, 0.26130258, 0.27577711], 'interpolation': 'bicubic', 'resize_mode': 'squash', 'fill_color': 0}
ğŸŸ© Model hf-hub:apple/DFN5B-CLIP-ViT-H-14-378 creation process complete.
ğŸŸ© OpenCLIPãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ¼ã®ãƒ©ãƒƒãƒ‘ãƒ¼ã‚’åˆæœŸåŒ–: dtype=torch.float32
ğŸŸ© UniversalTokenizerã‚’åˆæœŸåŒ–: name='openclip:hf-hub:apple/DFN5B-CLIP-ViT-H-14-378'
ğŸŸ© Parsing tokenizer identifier. Schema: hf-hub, Identifier: apple/DFN5B-CLIP-ViT-H-14-378
ğŸŸ© Attempting to load config from hf-hub:apple/DFN5B-CLIP-ViT-H-14-378
ğŸŸ© Using default SimpleTokenizer.
ğŸŸ© OpenCLIPãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã®ãƒ©ãƒƒãƒ‘ãƒ¼ã‚’åˆæœŸåŒ–
ğŸŸ© LatentDiffusionãƒ¢ãƒ‡ãƒ«ã‚’åˆæœŸåŒ–: dtype='bfloat16', latent_res=32, precomputed_latents=True, train_mask_ratio=0.75
